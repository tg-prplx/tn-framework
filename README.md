# üìö Terminal Novell Framework (TNF)

**TNF (Terminal Novell Framework)** ‚Äî –¥–≤–∏–∂–æ–∫ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è **–∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –Ω–æ–≤–µ–ª–ª**, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –ø—Ä—è–º–æ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ.

> –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç ASCII-–∞—Ä—Ç, –∏–≥—Ä–∞–µ—Ç –º—É–∑—ã–∫—É, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤—ã–±–æ—Ä—ã, –ª–æ–≥–∏–∫—É –Ω–∞ Lua –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è ‚Äî –≤—Å—ë –≤ –º–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω–æ–º CLI-—Å—Ç–∏–ª–µ.

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### üì¶ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

* Python **3.11+**

### üì• –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

### ‚è± –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∞–ª–∏–∞—Å–æ–≤

```bash
source path.sh
```

–¢–µ–ø–µ—Ä—å –¥–æ—Å—Ç—É–ø–Ω—ã —É–¥–æ–±–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:

```bash
tf-novell run folder . --from 1
scene-ide
```

---

## üóÇÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```plaintext
./
‚îú‚îÄ‚îÄ .nvlrc               # –∫–æ–Ω—Ñ–∏–≥ –Ω–æ–≤–µ–ª–ª—ã
‚îú‚îÄ‚îÄ scenes/              # JSON-—Ñ–∞–π–ª—ã —Å—Ü–µ–Ω (1.json, 2.json, ...)
‚îú‚îÄ‚îÄ images/              # —Ñ–æ–Ω—ã
‚îú‚îÄ‚îÄ music/               # –º—É–∑—ã–∫–∞
‚îú‚îÄ‚îÄ scripts/             # Lua-—Å–∫—Ä–∏–ø—Ç—ã –ª–æ–≥–∏–∫–∏
‚îî‚îÄ‚îÄ save.json            # —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
```

---

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (`.nvlrc`)

```ini
nvl-name=–ú–æ—è –ø–µ—Ä–≤–∞—è –Ω–æ–≤–µ–ª–ª–∞
scene-dir=scenes
save-file=save.json
```

| –ö–ª—é—á        | –û–ø–∏—Å–∞–Ω–∏–µ         |
| ----------- | ---------------- |
| `nvl-name`  | –ù–∞–∑–≤–∞–Ω–∏–µ –Ω–æ–≤–µ–ª–ª—ã |
| `scene-dir` | –ü–∞–ø–∫–∞ —Å–æ —Å—Ü–µ–Ω–∞–º–∏ |
| `save-file` | –§–∞–π–ª —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–π  |

---

## üé¨ –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ü–µ–Ω—ã

–ö–∞–∂–¥–∞—è —Å—Ü–µ–Ω–∞ ‚Äî `.json` —Ñ–∞–π–ª:

### üí° –ü—Ä–∏–º–µ—Ä

```json
{
  "id": 1,
  "text": "–ü—Ä–∏–≤–µ—Ç, —ç—Ç–æ –º–æ—è –ø–µ—Ä–≤–∞—è —Å—Ü–µ–Ω–∞!",
  "person": "–ì–ª–∞–≤–Ω—ã–π –≥–µ—Ä–æ–π",
  "background": "images/room.png",
  "music": "music/theme.mp3",
  "script": "scripts/scene1.lua"
}
```

### üß± –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è

| –ü–æ–ª–µ         | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ                    |
| ------------ | --- | --------------------------- |
| `id`         | int | –ù–æ–º–µ—Ä —Å—Ü–µ–Ω—ã                 |
| `text`       | str | –û—Å–Ω–æ–≤–Ω–æ–π —Ç–µ–∫—Å—Ç              |
| `person`     | str | –ò–º—è –≥–æ–≤–æ—Ä—è—â–µ–≥–æ              |
| `background` | str | –ü—É—Ç—å –∫ —Ñ–æ–Ω–æ–≤–æ–º—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é |

### üß© –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø–æ–ª—è

| –ü–æ–ª–µ     | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ          |
| -------- | --- | ----------------- |
| `music`  | str | –ü—É—Ç—å –∫ –º—É–∑—ã–∫–µ     |
| `script` | str | Lua-—Å–∫—Ä–∏–ø—Ç –ª–æ–≥–∏–∫–∏ |

---

## üîß Lua-—Å–∫—Ä–∏–ø—Ç—ã

–í –¥–≤–∏–∂–æ–∫ –≤—Å—Ç—Ä–æ–µ–Ω **Lua 5.1** —á–µ—Ä–µ–∑ `lupa`. –¢—ã –º–æ–∂–µ—à—å –¥–æ–ø–æ–ª–Ω—è—Ç—å —Å—Ü–µ–Ω—ã –ª–æ–≥–∏–∫–æ–π.

### üîÑ –û—Å–Ω–æ–≤–Ω—ã–µ —Ö—É–∫–∏

```lua
function modify_scene(scene)
    -- –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –î–û –ø–æ–∫–∞–∑–∞ —Å—Ü–µ–Ω—ã
    return scene
end

function post_scene(scene)
    -- –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ü–û–°–õ–ï –ø–æ–∫–∞–∑–∞ —Å—Ü–µ–Ω—ã
    return scene
end
```

---

## üìò Lua API –¥–≤–∏–∂–∫–∞

### üìç –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã

| –ú–µ—Ç–æ–¥                            | –ê—Ä–≥—É–º–µ–Ω—Ç—ã                                 | –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç | –û–ø–∏—Å–∞–Ω–∏–µ                          |
| -------------------------------- | ----------------------------------------- | ---------- | --------------------------------- |
| `engine.get_scene()`             | ‚Äì                                         | `table`    | –¢–µ–∫—É—â–∞—è —Å—Ü–µ–Ω–∞ –∫–∞–∫ Lua-—Ç–∞–±–ª–∏—Ü–∞     |
| `engine.load_scene(scene, exec)` | `scene`, `execute?` (bool)                | ‚Äì          | –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Å—Ü–µ–Ω—É, –ø—Ä–∏–º–µ–Ω—è–µ—Ç –ª–æ–≥–∏–∫—É |
| `engine.next_scene()`            | ‚Äì                                         | ‚Äì          | –°–ª–µ–¥—É—é—â–∞—è —Å—Ü–µ–Ω–∞                   |
| `engine.prev_scene()`            | ‚Äì                                         | ‚Äì          | –ü—Ä–µ–¥—ã–¥—É—â–∞—è —Å—Ü–µ–Ω–∞                  |
| `engine.custom_scene(id)`        | `id` (int)                                | ‚Äì          | –°—Ü–µ–Ω–∞ –ø–æ –Ω–æ–º–µ—Ä—É                   |
| `engine.apply_lua_logic(name)`   | `name` (str, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `modify_scene`) | ‚Äì          | –í—ã–ø–æ–ª–Ω—è–µ—Ç Lua-—Ñ—É–Ω–∫—Ü–∏—é –ø–æ –∏–º–µ–Ω–∏    |

---

### üéÆ –†–∞–±–æ—Ç–∞ —Å –≤—ã–±–æ—Ä–æ–º

| –ú–µ—Ç–æ–¥                          | –ê—Ä–≥—É–º–µ–Ω—Ç—ã                 | –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç | –û–ø–∏—Å–∞–Ω–∏–µ              |
| ------------------------------ | ------------------------- | ---------- | --------------------- |
| `engine.add_choice(name, txt)` | `name` (str), `txt` (str) | ‚Äì          | –î–æ–±–∞–≤–ª—è–µ—Ç –≤—ã–±–æ—Ä       |
| `engine.get_choice(name)`      | `name` (str)              | `str`      | –ü–æ–ª—É—á–∞–µ—Ç —Ç–µ–∫—Å—Ç –≤—ã–±–æ—Ä–∞ |
| `engine.delete_choice(name)`   | `name` (str)              | ‚Äì          | –£–¥–∞–ª—è–µ—Ç –≤—ã–±–æ—Ä         |

---

### üéµ –†–∞–±–æ—Ç–∞ —Å –º—É–∑—ã–∫–æ–π

| –ú–µ—Ç–æ–¥                     | –ê—Ä–≥—É–º–µ–Ω—Ç—ã         | –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç | –û–ø–∏—Å–∞–Ω–∏–µ                      |
| ------------------------- | ----------------- | ---------- | ----------------------------- |
| `engine.play_audio(path)` | `file_path` (str) | ‚Äì          | –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç –º—É–∑—ã–∫—É          |
| `engine.stop_audio()`     | ‚Äì                 | ‚Äì          | –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ |

---

### üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

| –ú–µ—Ç–æ–¥                     | –ê—Ä–≥—É–º–µ–Ω—Ç—ã              | –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç | –û–ø–∏—Å–∞–Ω–∏–µ                                    |
| ------------------------- | ---------------------- | ---------- | ------------------------------------------- |
| `engine.save_game(name?)` | `filename` (str, –æ–ø—Ü.) | ‚Äì          | –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ —Ñ–∞–π–ª (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `save.json`) |
| `engine.load_game(name?)` | `filename` (str, –æ–ø—Ü.) | ‚Äì          | –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ                        |

---

### üñºÔ∏è –û—Ç—Ä–∏—Å–æ–≤–∫–∞

| –ú–µ—Ç–æ–¥                   | –ê—Ä–≥—É–º–µ–Ω—Ç—ã | –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç | –û–ø–∏—Å–∞–Ω–∏–µ             |
| ----------------------- | --------- | ---------- | -------------------- |
| `engine.render_tab()`   | ‚Äì         | ‚Äì          | –†–∏—Å—É–µ—Ç –Ω–∏–∂–Ω—é—é –ø–∞–Ω–µ–ª—å |
| `engine.render_scene()` | ‚Äì         | ‚Äì          | ASCII-—Ñ–æ–Ω            |
| `engine.render()`       | ‚Äì         | ‚Äì          | –ü–æ–ª–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä —Å—Ü–µ–Ω—ã  |

---

### üñ•Ô∏è –ö–æ–Ω—Å–æ–ª—å–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã

| –ú–µ—Ç–æ–¥                        | –ê—Ä–≥—É–º–µ–Ω—Ç—ã    | –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç | –û–ø–∏—Å–∞–Ω–∏–µ                        |
| ---------------------------- | ------------ | ---------- | ------------------------------- |
| `engine.console.clear()`     | ‚Äì            | ‚Äì          | –û—á–∏—â–∞–µ—Ç —Ç–µ—Ä–º–∏–Ω–∞–ª                |
| `engine.console.print(text)` | `text` (str) | ‚Äì          | –ü–µ—á–∞—Ç—å —Ç–µ–∫—Å—Ç–∞ —Å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º |

---

### ‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫ –∏–≥—Ä–æ–≤–æ–≥–æ —Ü–∏–∫–ª–∞

```lua
engine.run()
```

---

## üîÅ –ü—Ä–∏–º–µ—Ä—ã Lua-–ª–æ–≥–∏–∫–∏

### 1. –ó–∞–º–µ–Ω–∞ —Ç–µ–∫—Å—Ç–∞

```lua
function modify_scene(scene)
    scene.text = "–≠—Ç–æ—Ç —Ç–µ–∫—Å—Ç –∑–∞–º–µ–Ω—ë–Ω"
    return scene
end
```

### 2. –í–≤–æ–¥ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```lua
function post_scene(scene)
    io.write("–í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ: ")
    engine.add_choice("choice_rand", io.read())
    engine.await_input = false
    return scene
end
```

### 3. –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞

```lua
function modify_scene(scene)
    local last = engine.get_choice("choice_rand")
    if last == "42" then
        scene.text = "—Ç—ã –≤—ã–±—Ä–∞–ª 42! –æ—Ñ–∏–≥–µ–Ω–Ω—ã–π –≤—ã–±–æ—Ä!"
    else
        scene.text = "—Å—Ç—Ä–∞–Ω–Ω—ã–π –≤—ã–±–æ—Ä... –Ω–æ –ª–∞–¥–Ω–æ."
    end
    return scene
end
```

---

## üß™ –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è

```bash
tf-novell validate
```

–ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞ –∏ –Ω–∞–ª–∏—á–∏–µ —Ñ–∞–π–ª–æ–≤.

### üëÅÔ∏è –ü—Ä–µ–≤—å—é —Å—Ü–µ–Ω—ã

```bash
tf-novell preview --scene 2
```

–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω—É—é —Å—Ü–µ–Ω—É –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ.

### ‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫ –Ω–æ–≤–µ–ª–ª—ã

```bash
tf-novell run folder . --from 1
```

---

## üõ† Scene-IDE

–ú–∏–Ω–∏-—Ä–µ–¥–∞–∫—Ç–æ—Ä –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ü–µ–Ω:

```bash
scene-ide
```

* —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ `.json` —Å –¥–∏–∞–ª–æ–≥–∞–º–∏
* –≤–∏–∑—É–∞–ª—å–Ω–æ–µ —É–∫–∞–∑–∞–Ω–∏–µ –ø—É—Ç–µ–π –∫ —Ñ–æ–Ω–∞–º, –º—É–∑—ã–∫–µ –∏ —Å–∫—Ä–∏–ø—Ç–∞–º
* —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ñ–∞–π–ª—ã –≤ –Ω—É–∂–Ω—É—é –ø–∞–ø–∫—É

---

## üí° –°–æ–≤–µ—Ç—ã

* –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π **–æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –ø—É—Ç–∏**
* –ü—Ä–æ–≤–µ—Ä—è–π **UTF-8 –∫–æ–¥–∏—Ä–æ–≤–∫—É** JSON-—Ñ–∞–π–ª–æ–≤
* –ü—Ä–æ–≥–æ–Ω—è–π `validate` –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º
* –ù–µ –ø–µ—Ä–µ–±–∞—Ä—â–∏–≤–∞–π —Å ASCII ‚Äî –º–æ–≥—É—Ç —Ç–æ—Ä–º–æ–∑–∏—Ç—å —Ç–µ—Ä–º–∏–Ω–∞–ª üòÖ

---

## üì¶ –°–±–æ—Ä–∫–∞ –Ω–æ–≤–µ–ª–ª—ã

(–≤ –±—É–¥—É—â–µ–º) –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–±–æ—Ä–∫–∏ `.nvlpkg` –∞—Ä—Ö–∏–≤–∞ –¥–ª—è —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –Ω–æ–≤–µ–ª–ª—ã.

---
