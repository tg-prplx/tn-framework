
---

# üìö Terminal Novell Framework (TNF) ‚Äî –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## üí° –ß—Ç–æ —Ç–∞–∫–æ–µ TNF?

**TNF (Terminal Novell Framework)** ‚Äî —ç—Ç–æ –¥–≤–∏–∂–æ–∫ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è **–∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –Ω–æ–≤–µ–ª–ª**, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –ø—Ä—è–º–æ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ.

–° TNF —Ç—ã –º–æ–∂–µ—à—å:

- –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —Å—Ü–µ–Ω—ã —Å ASCII-–∞—Ä—Ç–æ–º –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
    
- –¥–æ–±–∞–≤–ª—è—Ç—å —Ñ–æ–Ω–æ–≤—É—é –º—É–∑—ã–∫—É
    
- –ø–∏—Å–∞—Ç—å –¥–∏–∞–ª–æ–≥–∏ –∏ –≤—ã–±–æ—Ä—ã
    
- –≤—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –ª–æ–≥–∏–∫—É —á–µ—Ä–µ–∑ **Lua-—Å–∫—Ä–∏–ø—Ç—ã**
    
- —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∏ –∑–∞–≥—Ä—É–∂–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –∏–≥—Ä–æ–∫–∞
    

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è**:

- Python **3.6+**
    
- –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –º–æ–¥—É–ª–∏: `cv2`, `numpy`, `pygame`, `lupa`
    

```bash
pip install opencv-python numpy pygame lupa
```

### ‚è± –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∞–ª–∏–∞—Å–æ–≤

–î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ ‚Äî –ø–æ–¥–∫–ª—é—á–∏ —Å–∫—Ä–∏–ø—Ç —Å –ø—É—Ç—è–º–∏:

```bash
source path.sh
```

–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –∫–æ–º–∞–Ω–¥—ã –ø—Ä–æ—â–µ:

```bash
tf-novell run folder . --from 1
scene-ide
```

---

## üóÇÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```plaintext
./
‚îú‚îÄ‚îÄ .nvlrc               # –∫–æ–Ω—Ñ–∏–≥ –Ω–æ–≤–µ–ª–ª—ã
‚îú‚îÄ‚îÄ scenes/              # JSON-—Ñ–∞–π–ª—ã —Å—Ü–µ–Ω (1.json, 2.json, ...)
‚îú‚îÄ‚îÄ images/              # —Ñ–æ–Ω—ã
‚îú‚îÄ‚îÄ music/               # –º—É–∑—ã–∫–∞
‚îú‚îÄ‚îÄ scripts/             # Lua-—Å–∫—Ä–∏–ø—Ç—ã –ª–æ–≥–∏–∫–∏
‚îî‚îÄ‚îÄ save.json            # —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
```

---

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (.nvlrc)

–ü—Ä–∏–º–µ—Ä:

```
nvl-name=–ú–æ—è –ø–µ—Ä–≤–∞—è –Ω–æ–≤–µ–ª–ª–∞
scene-dir=scenes
save-file=save.json
```

–ü–æ—è—Å–Ω–µ–Ω–∏—è:

|–ö–ª—é—á|–û–ø–∏—Å–∞–Ω–∏–µ|
|---|---|
|`nvl-name`|–ù–∞–∑–≤–∞–Ω–∏–µ –Ω–æ–≤–µ–ª–ª—ã|
|`scene-dir`|–ü–∞–ø–∫–∞ —Å–æ —Å—Ü–µ–Ω–∞–º–∏|
|`save-file`|–§–∞–π–ª —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–π|

---

## üé¨ –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ü–µ–Ω—ã

–ö–∞–∂–¥–∞—è —Å—Ü–µ–Ω–∞ ‚Äî —ç—Ç–æ `.json` —Ñ–∞–π–ª:

### –ü—Ä–∏–º–µ—Ä:

```json
{
  "id": 1,
  "text": "–ü—Ä–∏–≤–µ—Ç, —ç—Ç–æ –º–æ—è –ø–µ—Ä–≤–∞—è —Å—Ü–µ–Ω–∞!",
  "person": "–ì–ª–∞–≤–Ω—ã–π –≥–µ—Ä–æ–π",
  "background": "images/room.png",
  "music": "music/theme.mp3",
  "script": "scripts/scene1.lua"
}
```

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è:

|–ü–æ–ª–µ|–¢–∏–ø|–û–ø–∏—Å–∞–Ω–∏–µ|
|---|---|---|
|`id`|int|–ù–æ–º–µ—Ä —Å—Ü–µ–Ω—ã|
|`text`|str|–û—Å–Ω–æ–≤–Ω–æ–π —Ç–µ–∫—Å—Ç|
|`person`|str|–ò–º—è –≥–æ–≤–æ—Ä—è—â–µ–≥–æ|
|`background`|str|–û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—É—Ç—å –∫ —Ñ–æ–Ω—É|

### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø–æ–ª—è:

| –ü–æ–ª–µ       | –¢–∏–ø  | –û–ø–∏—Å–∞–Ω–∏–µ                                |
| ---------- | ---- | --------------------------------------- |
| `music`    | str  | –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—É—Ç—å –∫ –º—É–∑—ã–∫–µ             |
| `script`   | str  | –ü—É—Ç—å –∫ Lua-—Å–∫—Ä–∏–ø—Ç—É                      |

---

## üîß Lua-—Å–∫—Ä–∏–ø—Ç—ã

TNF –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∫–∞—Å—Ç–æ–º–Ω—É—é –ª–æ–≥–∏–∫—É –Ω–∞ **Lua 5.1**, –≤—Å—Ç—Ä–æ–µ–Ω–Ω—É—é —á–µ—Ä–µ–∑ `lupa`.

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

```lua
function modify_scene(scene)
    -- –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –î–û –ø–æ–∫–∞–∑–∞ —Å—Ü–µ–Ω—ã
    return scene
end

function post_scene(scene)
    -- –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ü–û–°–õ–ï –ø–æ–∫–∞–∑–∞ —Å—Ü–µ–Ω—ã
    return scene
end
```

### –î–æ—Å—Ç—É–ø–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–≤–∏–∂–∫–∞

## üìò Lua API –¥–≤–∏–∂–∫–∞ TNF

| üîß –ú–µ—Ç–æ–¥                            | üìù –ê—Ä–≥—É–º–µ–Ω—Ç—ã                         | üì§ –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç | üóíÔ∏è –û–ø–∏—Å–∞–Ω–∏–µ                                                 |
| ----------------------------------- | ------------------------------------ | ------------- | ------------------------------------------------------------ |
| `engine.get_scene()`                | ‚Äì                                    | `table`       | –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–µ–∫—É—â—É—é —Å—Ü–µ–Ω—É –∫–∞–∫ —Ç–∞–±–ª–∏—Ü—É                         |
| `engine.load_scene(scene, execute)` | `scene` (—Ç–∞–±–ª–∏—Ü–∞), `execute?` (bool) | ‚Äì             | –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Å—Ü–µ–Ω—É, –ø—Ä–∏ `execute = true` –ø—Ä–∏–º–µ–Ω—è–µ—Ç —Å–∫—Ä–∏–ø—Ç       |
| `engine.next_scene()`               | ‚Äì                                    | ‚Äì             | –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–π —Å—Ü–µ–Ω–µ                                    |
| `engine.prev_scene()`               | ‚Äì                                    | ‚Äì             | –ü–µ—Ä–µ—Ö–æ–¥ –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Å—Ü–µ–Ω–µ                                   |
| `engine.custom_scene(id)`           | `id` (int)                           | ‚Äì             | –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å—Ü–µ–Ω–µ —Å –∑–∞–¥–∞–Ω–Ω—ã–º `id`                              |
| `engine.apply_lua_logic(name)`      | `name` (string)                      | ‚Äì             | –í—ã–ø–æ–ª–Ω—è–µ—Ç Lua-—Ñ—É–Ω–∫—Ü–∏—é –ø–æ –∏–º–µ–Ω–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `modify_scene`) |

---

## üéÆ –†–∞–±–æ—Ç–∞ —Å –≤—ã–±–æ—Ä–æ–º

| üîß –ú–µ—Ç–æ–¥                        | üìù –ê—Ä–≥—É–º–µ–Ω—Ç—ã               | üì§ –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç | üóíÔ∏è –û–ø–∏—Å–∞–Ω–∏–µ                       |
| ------------------------------- | -------------------------- | ------------- | ---------------------------------- |
| `engine.add_choice(name, text)` | `name` (str), `text` (str) | ‚Äì             | –î–æ–±–∞–≤–ª—è–µ—Ç –Ω–æ–≤—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –≤—ã–±–æ—Ä–∞     |
| `engine.get_choice(name)`       | `name` (str)               | `str`         | –ü–æ–ª—É—á–∞–µ—Ç —Ç–µ–∫—Å—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞ |
| `engine.delete_choice(name)`    | `name` (str)               | ‚Äì             | –£–¥–∞–ª—è–µ—Ç –≤—ã–±–æ—Ä –∏–∑ —Ç–∞–±–ª–∏—Ü—ã           |

---

## üéµ –†–∞–±–æ—Ç–∞ —Å –º—É–∑—ã–∫–æ–π

|üîß –ú–µ—Ç–æ–¥|üìù –ê—Ä–≥—É–º–µ–Ω—Ç—ã|üì§ –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç|üóíÔ∏è –û–ø–∏—Å–∞–Ω–∏–µ|
|---|---|---|---|
|`engine.play_audio(file_path)`|`file_path` (str)|‚Äì|–í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç –∞—É–¥–∏–æ|
|`engine.stop_audio()`|‚Äì|‚Äì|–û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –º—É–∑—ã–∫—É|

---

## üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∑–∞–≥—Ä—É–∑–∫–∞

|üîß –ú–µ—Ç–æ–¥|üìù –ê—Ä–≥—É–º–µ–Ω—Ç—ã|üì§ –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç|üóíÔ∏è –û–ø–∏—Å–∞–Ω–∏–µ|
|---|---|---|---|
|`engine.save_game(filename?)`|`filename` (str, –æ–ø—Ü.)|‚Äì|–°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏–≥—Ä—É –≤ —Ñ–∞–π–ª (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `"save.json"`)|
|`engine.load_game(filename?)`|`filename` (str, –æ–ø—Ü.)|‚Äì|–ó–∞–≥—Ä—É–∂–∞–µ—Ç –∏–≥—Ä—É –∏–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è|

---

## üñºÔ∏è –û—Ç—Ä–∏—Å–æ–≤–∫–∞

|üîß –ú–µ—Ç–æ–¥|üìù –ê—Ä–≥—É–º–µ–Ω—Ç—ã|üì§ –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç|üóíÔ∏è –û–ø–∏—Å–∞–Ω–∏–µ|
|---|---|---|---|
|`engine.render_tab()`|‚Äì|‚Äì|–†–∏—Å—É–µ—Ç –Ω–∏–∂–Ω—é—é –ø–∞–Ω–µ–ª—å —Å –≤—ã–±–æ—Ä–æ–º|
|`engine.render_scene()`|‚Äì|‚Äì|–†–∏—Å—É–µ—Ç ASCII-—Ñ–æ–Ω|
|`engine.render()`|‚Äì|‚Äì|–ü–æ–ª–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä —Å—Ü–µ–Ω—ã (—Ñ–æ–Ω + —Ç–µ–∫—Å—Ç + –≤—ã–±–æ—Ä)|

---

## üíª –†–∞–±–æ—Ç–∞ —Å –∫–æ–Ω—Å–æ–ª—å—é

|üîß –ú–µ—Ç–æ–¥|üìù –ê—Ä–≥—É–º–µ–Ω—Ç—ã|üì§ –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç|üóíÔ∏è –û–ø–∏—Å–∞–Ω–∏–µ|
|---|---|---|---|
|`engine.console.clear()`|‚Äì|‚Äì|–û—á–∏—â–∞–µ—Ç —Ç–µ—Ä–º–∏–Ω–∞–ª|
|`engine.console.print(text)`|`text` (str)|‚Äì|–í—ã–≤–æ–¥–∏—Ç —Ç–µ–∫—Å—Ç –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª —Å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º (rich)|

---

## ‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã

|üîß –ú–µ—Ç–æ–¥|üìù –ê—Ä–≥—É–º–µ–Ω—Ç—ã|üì§ –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç|üóíÔ∏è –û–ø–∏—Å–∞–Ω–∏–µ|
|---|---|---|---|
|`engine.run()`|‚Äì|‚Äì|–ó–∞–ø—É—Å–∫–∞–µ—Ç –∏–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª –Ω–æ–≤–µ–ª–ª—ã|

---

### üîÅ –ü—Ä–∏–º–µ—Ä—ã Lua-–ª–æ–≥–∏–∫–∏

**1. –ü—Ä–æ—Å—Ç–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞**

```lua
function modify_scene(scene)
    scene.text = "–≠—Ç–æ—Ç —Ç–µ–∫—Å—Ç –∑–∞–º–µ–Ω—ë–Ω"
    return scene
end
```

**2. –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≤–≤–æ–¥**

```lua
function post_scene(scene)
    io.write("–í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ: ")
    engine.add_choice("choice_rand", io.read())
    engine.await_input = false
    return scene
end
```

**3. –†–∞–±–æ—Ç–∞ —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º –≤—ã–±–æ—Ä–æ–º**

```lua
function modify_scene(scene)
    local last = engine.get_choice("choice_rand")
    if last == "42" then
        scene.text = "—Ç—ã –≤—ã–±—Ä–∞–ª 42! –æ—Ñ–∏–≥–µ–Ω–Ω—ã–π –≤—ã–±–æ—Ä!"
    else
        scene.text = "—Å—Ç—Ä–∞–Ω–Ω—ã–π –≤—ã–±–æ—Ä... –Ω–æ –ª–∞–¥–Ω–æ."
    end
    return scene
end
```

---

## üß™ –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

```bash
tf-novell validate
```

- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Å—Ü–µ–Ω, –Ω–∞–ª–∏—á–∏–µ –Ω—É–∂–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤.
    

### üëÅÔ∏è –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Å—Ü–µ–Ω—ã

```bash
tf-novell preview --scene 2
```

- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é —Å—Ü–µ–Ω—É, –∫–∞–∫ –æ–Ω–∞ –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å –≤ –∏–≥—Ä–µ.
    

### ‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫ –Ω–æ–≤–µ–ª–ª—ã

```bash
tf-novell run folder . --from 1
```

- –ó–∞–ø—É—Å–∫ —Å —É–∫–∞–∑–∞–Ω–Ω–æ–π —Å—Ü–µ–Ω—ã.
    

---

## üõ† Scene-IDE (–º–∏–Ω–∏-—Ä–µ–¥–∞–∫—Ç–æ—Ä)

–ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Ç–∞–∫:

```bash
scene-ide
```

–ü–æ–∑–≤–æ–ª—è–µ—Ç:

- –±—ã—Å—Ç—Ä–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ü–µ–Ω—ã
    
- —É–∫–∞–∑—ã–≤–∞—Ç—å –ø—É—Ç–∏ –∫ —Ñ–∞–π–ª–∞–º —á–µ—Ä–µ–∑ –¥–∏–∞–ª–æ–≥
    
- —Å–æ—Ö—Ä–∞–Ω—è—Ç—å `.json` –≤ –Ω—É–∂–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
    

---

## üß† –°–æ–≤–µ—Ç—ã

- –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π **–æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –ø—É—Ç–∏** (`images/—Ñ–æ–Ω.png`, –∞ –Ω–µ `/home/...`)
    
- –°–ª–µ–¥–∏ –∑–∞ **–∫–æ–¥–∏—Ä–æ–≤–∫–æ–π UTF-8** –≤ JSON
    
- –í–∞–ª–∏–¥–∞—Ü–∏—é –¥–µ–ª–∞–π –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º –∑–∞–ø—É—Å–∫–æ–º
    
- –ò—Å–ø–æ–ª—å–∑—É–π ASCII-—Ñ–æ–Ω—ã —É–º–µ—Ä–µ–Ω–Ω–æ ‚Äî –æ–Ω–∏ –º–æ–≥—É—Ç —Ç–æ—Ä–º–æ–∑–∏—Ç—å
    

---

## üì¶ –°–±–æ—Ä–∫–∞ —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –Ω–æ–≤–µ–ª–ª—ã

(–≤ –±—É–¥—É—â–µ–º) –º–æ–∂–Ω–æ –±—É–¥–µ—Ç —É–ø–∞–∫–æ–≤–∞—Ç—å –ø—Ä–æ–µ–∫—Ç –≤ `.nvlpkg` –∞—Ä—Ö–∏–≤ ‚Äî –ø–æ–∫–∞ —ç—Ç–∞ —á–∞—Å—Ç—å –Ω–∞ —Å—Ç–∞–¥–∏–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.

---